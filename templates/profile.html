<!DOCTYPE html>
<html>
   <head>
      <title>Bootstrap 模板</title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta http-equiv="X-UA-Compatible" content="ie=edge">
      <!-- 引入 Bootstrap -->
      <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
      <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
      <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    </head>
      <!-- HTML5 Shiv 和 Respond.js 用于让 IE8 支持 HTML5元素和媒体查询 -->
      <!-- 注意： 如果通过 file://  引入 Respond.js 文件，则该文件无法起效果 -->
      <!--[if lt IE 9]>
         <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
         <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
      <![endif]-->
      <title>用户个人中心</title>
   </head>
<body>
    {% if user %}
        {# 用户已登陆，显示个人信息和历史纪录 #}
        <h4>个人信息</h4>
        <ul>
            <li>姓名：{{ user.name }}</li>
            <li>学号：{{ user.sno }}</li>
            <li>电话：{{ user.phone }}</li>
            <li>邮箱：{{ user.email }}</li>
        </ul>

        <p>--------------------------------------------</p>

        <h4><a href="{% url 'profile' nav_id=0 %}">我的失物信息</a></h4>
        <h4><a href="{% url 'profile' nav_id=1 %}">我的招领信息</a></h4>
        {% if user.tag %}
            {# 用户为管理员才有审核功能 #}
            <h4><a href="{% url 'profile' nav_id=2 %}">审核信息</a></h4>
        {% endif %}
        <p>--------------------------------------------</p>
        <form action="" method="POST">
        {% if nav_id == '0' %}
            {% if lost_no_history %}
                {# 用户没有失物历史记录 #}
                <p>您还没有发布过任何失物信息。</p>
            {% else %}
                <ul>
                {% for obj in lostobjs %}
                    {# 超链接 object/20位长度id #}
                    <li>
                        <input type="checkbox" name="object" value={{obj.id}} />
                        <a href={% url 'object' obj.id %}>
                        失物信息:【{{obj.name}}】【物品编号：{{obj.id}}】
                        </a>

                    </li>
                    {% if obj.state == 0%}<p>未审核</p>
                    {% elif obj.state == 1%}<p>未完成</p>
                    {% elif obj.state == 2%}<p>已完成</p>
                    {% else %}<p>未通过审核</p>
                    {% endif %}
                {% endfor %}
                </ul>
                <p>--------------------------------------------</p>
                <input class="btn btn-default" type="submit" name="delete" value="删除" />
                <button class="btn btn-primary btn-lg" type="button" data-toggle="modal" data-target="#myModal">完成</button>
                <!--上面要加上type="button" 不然对话框只是一闪而过 -->
            {% endif %}
        {% endif %}

        {% if nav_id == '1' %}
            {% if found_no_history %}
                {# 用户没有招领历史记录 #}
                <p>您还没有发布过任何招领信息。</p>
            {% else %}
                <ul>
                {% for obj in foundobjs %}
                    {# 超链接 object/20位长度id #}
                    <li><input type="checkbox" name="object" value={{obj.id}} />
                        <a href={% url 'object' obj.id %}>
                            招领信息:【{{obj.name}}】【物品编号：{{obj.id}}】
                        </a>
                    </li>
                    {% if obj.state == 0%}未审核
                    {% elif obj.state == 1%}未完成
                    {% elif obj.state == 2%}已完成
                    {% else %}未通过审核
                    {% endif %}
                {% endfor %}
                </ul>
                <p>--------------------------------------------</p>
                <input class="btn btn-default" type="submit" name="delete" value="删除" />
                <button class="btn btn-primary btn-lg" type="button" data-toggle="modal" data-target="#myModal">完成</button>
            {% endif %}
        {% endif %}


        {% if nav_id == '2' and user.tag %}
        {# 审核功能 #}
            {% if review_no_history %}
                <p>目前无待审核的物品</p>
            {% else %}
                {% for obj in obj_review %}
                <li><a href="{% url 'object' obj.id %}">{{obj.id}}{{obj.name}}</a></li>
                    {# value={{obj.id}}注意和后面的/隔开,不然value的值后面会加上/ #}
                {% endfor %}
            {% endif %}
        {% endif %}
        <p>--------------------------------------------</p>
        <a href="../main">返回首页</a>
        <a href="/quit">退出</a>
    {% else %}
        {# 没有用户登陆-提示登陆 #}
        出错：当前未登陆。<a href="/login">点此登陆</a>
    {% endif %}



<!-- 模态框（Modal） -->

<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">请输入对方学号</h4>
            </div>
            <div class="modal-body">
                学号<input type="text" name="finish_id" value="" />
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <input type="submit" name="finish" class="btn btn-primary" value="提交" />
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>
</form>




</body>
</html>